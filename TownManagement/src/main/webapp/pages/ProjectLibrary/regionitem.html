<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>区域性项目</title>
</head>
<!-- select CSS -->
<link href="/TownManagement/dist/css/bootstrap-select.css" rel="stylesheet">
<!-- 表单验证 -->
<link rel="stylesheet" href="/TownManagement/dist/css/bootstrapValidator.css" />
<!-- 时间插件 -->
<link rel="stylesheet" href="/TownManagement/css/bootstrap-datetimepicker.css" />
<body>
	<div class="row">
		<div class="col-lg-12">
			<h3 class="page-header">区域性项目信息</h3>
		</div>
	</div>
	<div class="panel panel-default">
		<div class="panel-body">
			<form class="form-horizontal" role="form" id="regionitem">
				<!-- 表单 -->
				<div class="form-group">
					<!-- 一行行开始写 -->
					<label class="col-sm-2 control-label">区域性项目名称</label>
					<div class="col-sm-6">
						<input id="regname" name="regname" class="form-control"
							type="text" placeholder="请填写项目名称" />
					</div>
					<label class="col-sm-2 control-label">编号</label>
					<div class="col-sm-2">
						<input id="regnumber" name="regnumber" class="form-control" />
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-2 control-label">所属地区</label>
					<div class="col-sm-2">
						<input id="regarea" name="regarea" class="form-control"
							type="text">
					</div>
					<label class="col-sm-2 control-label">项目属性</label>
					<div class="col-sm-2">
						<select name="regproperty" id="regproperty"
							class="selectpicker show-tick form-control">
							<option></option>
							<option value="国家重点项目">国家重点项目</option>
							<option value="省级重点项目">省级重点项目</option>
							<option value="市级重点项目">市级重点项目</option>
							<option value="区县级重点项目">区县级重点项目</option>
						</select>
					</div>
					<label class="col-sm-2 control-label">当前进度</label>
					<div class="col-sm-2">
						<select name="regschedule" id="regschedule"
							class="selectpicker show-tick form-control">
							<option></option>
							<option value="立项">立项</option>
							<option value="环境影响评价">环境影响评价</option>
							<option value="初步设计">初步设计</option>
							<option value="用地审批">用地审批</option>
							<option value="招标">招标</option>
							<option value="开工">开工</option>
						</select>
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-2 control-label">地理位置</label>
					<div class="col-sm-10">
						<input id="regposition" name="regposition" class="form-control"
							type="text">
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-2 control-label">开发主体</label>
					<div class="col-sm-4">
						<input id="regdeveloper" name="regdeveloper" class="form-control"
							type="text">
					</div>
					<label class="col-sm-2 control-label">负责人</label>
					<div class="col-sm-2">
						<input id="regcharge" name="regcharge" class="form-control"
							type="text" placeholder="姓名">
					</div>
					<div class="col-sm-2">
						<input id="regchargetel" name="regchargetel" class="form-control"
							type="text" placeholder="电话">
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-2 control-label">合作单位</label>
					<div class="col-sm-4">
						<input id="regpartner" name="regpartner" class="form-control"
							type="text">
					</div>
					<label class="col-sm-2 control-label">负责人</label>
					<div class="col-sm-2">
						<input id="regpartcharge" name="regpartcharge"
							class="form-control" type="text" placeholder="姓名">
					</div>
					<div class="col-sm-2">
						<input id="regparttel" name="regparttel" class="form-control"
							type="text" placeholder="电话">
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-2 control-label">合作条件</label>
					<div class="col-sm-10">
						<select name="regterms" id="regterms"
							class="selectpicker show-tick form-control">
							<option></option>
							<option value="PPP合作">PPP合作</option>
						</select>
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-2 control-label">合作时间</label>
					<div class="col-sm-3">
						<input id="regtimebegin" name="regtimebegin"
							class="datepicker form-control" type="text" placeholder="合作开始时间">
					</div>
					<div class="col-sm-3">
						<input id="regtimeend" name="regtimeend"
							class="datepicker form-control" type="text" placeholder="合作结束时间">
					</div>
					<label class="col-sm-2 control-label">协议情况</label>
					<div class="col-sm-2">
						<select name="regprotocol" id="regprotocol"
							class="selectpicker show-tick form-control">
							<option></option>
							<option value="未签">未签</option>
							<option value="已签">已签</option>
						</select>
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-2 control-label">咨询顾问单位</label>
					<div class="col-sm-6">
						<input id="regadvisory" name="regadvisory" class="form-control"
							type="text">
					</div>
					<label class="col-sm-2 control-label">协议情况</label>
					<div class="col-sm-2">
						<select name="regadvisorypro" id="regadvisorypro"
							class="selectpicker show-tick form-control">
							<option></option>
							<option value="未签">未签</option>
							<option value="已签">已签</option>
						</select>
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-2 control-label">规划面积</label>
					<div class="col-sm-2">
						<input id="regplanarea" name="regplanarea" class="form-control"
							type="text">
					</div>
					<label class="col-sm-2 control-label">计划投资</label>
					<div class="col-sm-2">
						<input id="regplaninvest" name="regplaninvest"
							class="form-control" type="text">
					</div>
					<label class="col-sm-2 control-label">征地面积</label>
					<div class="col-sm-2">
						<input id="reglandarea" name="reglandarea" class="form-control"
							type="text">
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-2 control-label">一期规划面积</label>
					<div class="col-sm-2">
						<input id="regfirstplanarea" name="regfirstplanarea"
							class="form-control" type="text">
					</div>
					<label class="col-sm-2 control-label">一期计划投资</label>
					<div class="col-sm-2">
						<input id="regfirstplaninvest" name="regfirstplaninvest"
							class="form-control" type="text">
					</div>
					<label class="col-sm-2 control-label">征地面积</label>
					<div class="col-sm-2">
						<input id="regfirstlandarea" name="regfirstlandarea"
							class="form-control" type="text">
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-2 control-label">主导产业</label>
					<div class="col-sm-10">
						<select name="regprimeindustry" id="regprimeindustry"
							class="selectpicker show-tick form-control">
							<option></option>
							<option value="贸易物流">贸易物流</option>
							<option value="仓储物流">仓储物流</option>
							<option value="电子商务">电子商务</option>
						</select>
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-2 control-label">规划内容</label>
					<div class="col-sm-10">
						<input id="regplancontent" name="regplancontent"
							class="form-control" type="text">
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-2 control-label">现状地图</label>
					<div class="col-sm-2">
						<input id="regstatemap" name="regstatemap" class="form-control"
							type="text">
					</div>
					<label class="col-sm-2 control-label">规划方案</label>
					<div class="col-sm-2">
						<input id="regplanscheme" name="regplanscheme"
							class="form-control" type="text">
					</div>
					<label class="col-sm-2 control-label">对接人</label>
					<div class="col-sm-2">
						<input id="regcontacts" name="regcontacts" class="form-control"
							type="text">
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-2 control-label">规划图</label>
					<div class="col-sm-10">
						<input id="regplanmap" name="regplanmap" class="form-control"
							type="text">
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-5 control-label"></label>
					<button type="button" id="regionitem_update"
						class="col-sm-2 btn btn-primary"
						style="width: auto; min-width: 90px; margin-top: 20px;display:none;">更新</button>
					<label class="col-sm-5 control-label"></label>
					<input type="hidden" value="" name="regid" id="regid">
				</div>
			</form>
		</div>
	</div>
	<!-- Select JavaScript -->
	<script src="/TownManagement/dist/js/bootstrap-select.js"></script>
	<!-- 表单验证 -->
	<script type="text/javascript" src="/TownManagement/dist/js/bootstrapValidator.js"></script>
	<script type="text/javascript" src="/TownManagement/dist/js/language/zh_CN.js"></script>
	<!-- 时间插件 -->
	<script type="text/javascript" src="/TownManagement/js/bootstrap-datetimepicker.js"></script>
	<script type="text/javascript" src="/TownManagement/js/locales/bootstrap-datetimepicker.zh-CN.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			//初始化下拉框
			$('.selectpicker').selectpicker({
				noneSelectedText : "请选择"
			});
			$('.datepicker').datetimepicker({
				language: "zh-CN",
	            autoclose: true,//选中之后自动隐藏日期选择框
	            todayBtn: true,//今日按钮
	            minView: 2,
	            format: "yyyy-mm-dd"
			}).on('hide', function(e) {  
		        // Revalidate the date when user change it  
		        $('#regionitem').bootstrapValidator('revalidateField', 'regtimebegin');
		        $('#regionitem').bootstrapValidator('revalidateField', 'regtimeend');
			});
			//区域性项目表单更新
			$('#regionitem_update').click(function() {
				$('#regionitem').data('bootstrapValidator').validate();
				if (!$('#regionitem').data('bootstrapValidator').isValid()) {
					return;
					}
				/*ie11一下不支持，formdata的方法  */
				var formData = new FormData($("#regionitem")[0]);
				$.ajax({
					type : "post",
					url : "/TownManagement/regionmanage/updateregion",
					data : formData,
					dataType : 'JSON',
					cache : false,
					processData : false,
					contentType : false,
					success : function(data,status) {
						if (data.returnInfo == "success") {
							$("#regionmodal").modal('hide');
							setTimeout(function(){
								$("#region-success").modal('show');
								$('#regionManage').bootstrapTable('refresh');
							},200);
						} else {
							$("#region-fail").modal('show');
						}
					},
					error : function() {
						$("#region-fail").modal('show');
					}
				});
			});
			$('#regionitem').bootstrapValidator({
				message : 'This value is not valid',
				excluded : [ ':disabled' ],
				feedbackIcons : {
					valid : 'glyphicon glyphicon-ok',
					invalid : 'glyphicon glyphicon-remove',
					validating : 'glyphicon glyphicon-refresh'
				},
				fields : {
					regname : {
						validators : {
							notEmpty : {
								message : '项目名称不能为空'
							}
						}
					},
					regnumber : {
						validators : {
							notEmpty : {
								message : '编号不能为空'
							},
							regexp : {
								regexp : /^[0-9]*$/,
								message : '请输入整数'
							}
						}
					},
					regarea : {
						validators : {
							notEmpty : {
								message : '所属地区不能为空'
							}
						}
					},
					regproperty : {
						validators : {
							notEmpty : {
								message : '项目属性不能为空'
							}
						}
					},
					regschedule : {
						validators : {
							notEmpty : {
								message : '当前进度不能为空'
							}
						}
					},
					regposition : {
						validators : {
							notEmpty : {
								message : '地理位置不能为空'
							}
						}
					},
					regdeveloper : {
						validators : {
							notEmpty : {
								message : '开发主体不能为空'
							}
						}
					},
					regcharge : {
						validators : {
							notEmpty : {
								message : '开发负责人不能为空'
							}
						}
					},
					regchargetel : {
						validators : {
							notEmpty : {
								message : '负责人电话不能为空'
							}
						}
					},
					regpartner : {
						validators : {
							notEmpty : {
								message : '合作单位不能为空'
							}
						}
					},
					regpartcharge : {
						validators : {
							notEmpty : {
								message : '负责人不能为空'
							}
						}
					},
					regparttel : {
						validators : {
							notEmpty : {
								message : '负责人电话不能为空'
							}
						}
					},
					regterms : {
						validators : {
							notEmpty : {
								message : '合作条件不能为空'
							}
						}
					},
					regtimebegin : {
						validators : {
							notEmpty : {
								message : '合作时间不能为空'
							},  
							callback: {
								message: '开始日期不能大于结束日期',
								callback:function(value, validator,$field,options){
									var end = $('#regionitem').find("input[name='regtimeend']").val();
									return value<=end;
								}
							}
						}
					},
					regtimeend : {
						validators : {
							notEmpty : {
								message : '合作时间不能为空'
							},  
							callback: {
								message: '结束日期不能小于开始日期',
								callback:function(value, validator,$field){
									var begin = $('#regionitem').find("input[name='regtimebegin']").val();
									return value>=begin;
								}
							}
						}
					},
					regprotocol : {
						validators : {
							notEmpty : {
								message : '协议情况不能为空'
							}
						}
					},
					regadvisory : {
						validators : {
							notEmpty : {
								message : '咨询顾问单位不能为空'
							}
						}
					},
					regadvisorypro : {
						validators : {
							notEmpty : {
								message : '协议情况不能为空'
							}
						}
					},
					regplanarea : {
						validators : {
							notEmpty : {
								message : '规划面积不能为空'
							},
							regexp : {
								regexp : /^[0-9]+(.[0-9]{1,3})?$/,
								message : '请输入最多3位小数的数字'
							}
						}
					},
					regplaninvest : {
						validators : {
							notEmpty : {
								message : '计划投资不能为空'
							},
							regexp : {
								regexp : /^[0-9]+(.[0-9]{1,3})?$/,
								message : '请输入最多3位小数的数字'
							}
						}
					},
					reglandarea : {
						validators : {
							notEmpty : {
								message : '征地面积不能为空'
							},
							regexp : {
								regexp : /^[0-9]+(.[0-9]{1,3})?$/,
								message : '请输入最多3位小数的数字'
							}
						}
					},
					regfirstplanarea : {
						validators : {
							notEmpty : {
								message : '一期征地面积不能为空'
							},
							regexp : {
								regexp : /^[0-9]+(.[0-9]{1,3})?$/,
								message : '请输入最多3位小数的数字'
							}
						}
					},
					regfirstplaninvest : {
						validators : {
							notEmpty : {
								message : '一期计划投资不能为空'
							},
							regexp : {
								regexp : /^[0-9]+(.[0-9]{1,3})?$/,
								message : '请输入最多3位小数的数字'
							}
						}
					},
					regfirstlandarea : {
						validators : {
							notEmpty : {
								message : '征地面积不能为空'
							},
							regexp : {
								regexp : /^[0-9]+(.[0-9]{1,3})?$/,
								message : '请输入最多3位小数的数字'
							}
						}
					},
					regprimeindustry : {
						validators : {
							notEmpty : {
								message : '主导产业不能为空'
							}
						}
					},
					regplancontent : {
						validators : {
							notEmpty : {
								message : '规划内容不能为空'
							}
						}
					},
					regstatemap : {
						validators : {
							notEmpty : {
								message : '现状地图不能为空'
							}
						}
					},
					regplanscheme : {
						validators : {
							notEmpty : {
								message : '规划方案不能为空'
							}
						}
					},
					regcontacts : {
						validators : {
							notEmpty : {
								message : '对接人不能为空'
							}
						}
					},
					regplanmap : {
						validators : {
							notEmpty : {
								message : '规划图不能为空'
							}
						}
					}
				}
			});
		})
	</script>
</body>
</html>